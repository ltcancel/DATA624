---
title: "Data624 - Project 1"
author: "Esteban Aramayo, Coffy Andrews-Guo, LeTicia Cancel, Joseph Connolly, Ian Costello"
date: '2022-06-21'
output: 
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: 2
  word_document:
    toc: yes
    toc_depth: '2'
---

```{r global-options, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE,
                      message=FALSE,
                      collapse = FALSE,
                      comment = "#>" )
```


```{r warning=FALSE}
#libraries
library(readxl)
library(tidyverse)
library(ggplot2)
library(patchwork)
library(fpp2)
library(caret)
library(RANN)
library(VIM)
```

# Project Summary

De-identified data was provided to conduct a series of six forecasts of different variables of a provided data set. There are two major requirements of this project:

1. This written report
2. The forecasts and error rates

```{r}
df <- read_excel("data.xls")
head(df)
```

## Data Exploration

The data set does not appear to have any distinguishing labels that would indicate anything about the source or purpose of the data set. Under normal circumstances, context about data and use case is important for forecasting. Context may help identify the kinds of methods and models that would be best suited to produce an accurate result - following the "no free lunch" principle. 

Starting with some data exploration using `summary()` 

each predictor has NA values but I'm not sure what proportion of the data is NA yet. Column Var02's values differ the most when compared to the other Var## columns. So we will see how that impacts the data.
```{r}
summary(df)
```
Boxplots: Var02 has the most outliers but this is also the column with the largest range in values
```{r warning=FALSE, fig.width=10, fig.height=8}
p1 <- ggplot(df, aes(category, Var01)) +
  geom_boxplot()
p2 <- ggplot(df, aes(category, Var02)) +
  geom_boxplot()
p3 <- ggplot(df, aes(category, Var03)) +
  geom_boxplot()
p4 <- ggplot(df, aes(category, Var05)) +
  geom_boxplot()
p5 <- ggplot(df, aes(category, Var07)) +
  geom_boxplot()

p1+p2+p3+p4+p5+
  plot_layout(ncol = 2)
```

All predictors are left skewed so transformations are needed for each column
```{r warning=FALSE, fig.width=10, fig.height=7}
p1 <- ggplot(df, aes(Var01, color=category)) +
  geom_density()
p2 <- ggplot(df, aes(Var02, color=category)) +
  geom_density()
p3 <- ggplot(df, aes(Var03, color=category)) +
  geom_density()
p4 <- ggplot(df, aes(Var05, color=category)) +
  geom_density()
p5 <- ggplot(df, aes(Var07, color=category)) +
  geom_density()

p1+p2+p3+p4+p5+
  plot_layout(ncol = 2)
```

The NAs make up less than 10% of all values in the data. 

```{r}
preProcess_missingdata_model <- preProcess(as.data.frame(df), method='knnImpute')
df <- predict(preProcess_missingdata_model, newdata = df)
anyNA(df)
```

## Data transformations

Var02 is the most skewed
```{r}
library(moments)
skewness(df$Var01, na.rm = TRUE)
skewness(df$Var02, na.rm = TRUE)
skewness(df$Var03, na.rm = TRUE)
skewness(df$Var05, na.rm = TRUE)
skewness(df$Var07, na.rm = TRUE)
```

Experimenting with 3 different transformations; log, square root, and cube root. The log transformation looks the most normalized
```{r error=FALSE}
log_var01 <- log10(df$Var01)
sqrt_var01 <- sqrt(df$Var01)
cube_var01 <- df$Var01^(1/3)

hist(df$Var01)
hist(log_var01)
hist(sqrt_var01)
hist(cube_var01)


```

Transform all predictors using log transformation
```{r}
df_transformed <- df
df_transformed$Var01 <- log10(df$Var01)
df_transformed$Var02 <- log10(df$Var02)
df_transformed$Var03 <- log10(df$Var03)
df_transformed$Var05 <- log10(df$Var05)
df_transformed$Var07 <- log10(df$Var07)
```

New plots using transformed dataframe. Var02 is the most normalize so I will try different transformations with the other columns
```{r warning=FALSE, fig.width=10, fig.height=7}
p1 <- ggplot(df_transformed, aes(Var01, color=category)) +
  geom_density()
p2 <- ggplot(df_transformed, aes(Var02, color=category)) +
  geom_density()
p3 <- ggplot(df_transformed, aes(Var03, color=category)) +
  geom_density()
p4 <- ggplot(df_transformed, aes(Var05, color=category)) +
  geom_density()
p5 <- ggplot(df_transformed, aes(Var07, color=category)) +
  geom_density()

p1+p2+p3+p4+p5+
  plot_layout(ncol = 2)
```

```{r}
s01 <- df_transformed %>% dplyr::filter(category == "S01")
s02 <- df_transformed %>% dplyr::filter(category == "S02")
s03 <- df_transformed %>% dplyr::filter(category == "S03")
s04 <- df_transformed %>% dplyr::filter(category == "S04")
s05 <- df_transformed %>% dplyr::filter(category == "S05")
s06 <- df_transformed %>% dplyr::filter(category == "S06")
```





